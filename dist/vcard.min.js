!function(e){function n(e){for(var n,t,o,f,u,i={},c=e.split(/\r\n|\r|\n/),p=c.length,s=0,l=0;l<p;l++)if(""!=c[l])if(c[l].toUpperCase()!=r){if(c[l].toUpperCase()!=a){n=c[l].split(":"),t=n.shift(),o=n.join(":"),u=!1,f={};var v=function(e){return e+1<p&&(" "==c[e+1][0]||"\t"==c[e+1][0])};if(v(l))for(;v(l);)o+=c[l+1].trim(),l++;if(t.match(/;/)){t=t.replace(/\\;/g,"ΩΩΩ").replace(/\\,/,",");var h=t.split(";").map(function(e){return e.replace(/ΩΩΩ/g,";")});t=h.shift(),h.forEach(function(e){var n=e.split("=");n[0]=n[0].toLowerCase(),f[n[0]]?f[n[0]].push(n[1]):f[n[0]]=[n[1]]})}if(o=o.replace(/\\n/g,"\n").replace(/\\,/g,","),o.match(/;/)&&(o=o.replace(/\\;/g,"ΩΩΩ"),o.match(/;/)?(o=o.split(";"),o=o.map(function(e){return e.replace(/ΩΩΩ/g,";")})):o=o.replace(/ΩΩΩ/g,";")),t.match(/\./)){var d=t.split(".");t=d[1],u=d[0]}var g={value:o};Object.keys(f).length&&(g.meta=f),u&&(g.namespace=u),0!==t.indexOf("X-")&&(t=t.toLowerCase());var m={};"undefined"==typeof i[s]?(m[t]=g,i[s]=m):("undefined"==typeof i[s][t]&&(i[s][t]=[]),m[t]=g,i[s][t].push(g))}}else s++;return i}function t(e,n){var t=[r],f="";n&&!e.version&&(e.version=[{value:"3.0"}]),n&&!e.uid&&(e.uid=[{value:o()}]);var u=function(e){return e.replace(/\n/g,"\\n").replace(/;/g,"\\;").replace(/,/g,"\\,")};return Object.keys(e).forEach(function(n){e[n]&&"function"==typeof e[n].forEach&&e[n].forEach(function(e){if("undefined"!=typeof e.value&&""!=e.value){if(e.value instanceof Array){for(var r=!0,a=0;a<e.value.length;a++)if("undefined"!=typeof e.value[a]&&""!=e.value[a]){r=!1;break}if(r)return}if(f="",e.namespace&&(f+=e.namespace+"."),f+=0===n.indexOf("X-")?n:n.toUpperCase(),"object"==typeof e.meta&&Object.keys(e.meta).forEach(function(n){"function"==typeof e.meta[n].forEach&&e.meta[n].forEach(function(e){f+=";"+u(n.toUpperCase())+"="+u(e)})}),f+=":","string"==typeof e.value?f+=u(e.value):(e.value=e.value.map(function(e){return u(e)}),f+=e.value.join(";")),f.length>75){var o=f.substr(0,75),i=f.substr(75),c=i.match(/.{1,74}/g);t.push(o),c.forEach(function(e){t.push(" "+e)})}else t.push(f)}})}),t.push(a),t.join("\r\n")}var r="BEGIN:VCARD",a="END:VCARD",o=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return function(){return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}}();e.vCard={parse:n,generate:t}}("undefined"!=typeof window?window:module.exports);